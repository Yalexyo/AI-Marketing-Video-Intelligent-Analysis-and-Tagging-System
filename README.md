# 🤖 AI 营销视频智能分析与标签系统

> 基于多AI模型的智能视频内容分析和处理平台，专为婴幼儿奶粉营销视频优化设计

## 🌟 系统概述

AI 营销视频智能分析与标签系统是一个完整的视频内容分析和处理系统，集成了视频切片、语音识别、AI分析、智能标签和数据管理等功能。系统采用模块化设计，支持从原始视频到结构化数据的全流程自动化处理。

## 🎨 系统UI使用指南

系统提供直观的Web界面，支持三步式操作流程，让视频分析变得简单高效。

### 📋 步骤概览

系统采用三步式工作流程：

1. **步骤1：配置分析** - 设置输入输出路径和产品类型
2. **步骤2：分析处理** - 实时监控分析进度和状态
3. **步骤3：结果查看** - 查看分析结果和统计数据

### 🔧 步骤1：配置分析

在开始分析之前，需要完成以下配置：

#### 1.1 文件目录配置

**左侧文件目录面板：**

- **原始视频 输入目录**：选择包含待分析视频的文件夹路径
  - 点击文件夹图标浏览并选择输入目录
  - 系统会自动扫描目录中的视频文件

- **生成结果 输出目录**：选择分析结果的保存路径
  - 点击文件夹图标浏览并选择输出目录
  - 分析结果将按类别自动分类保存到此目录

#### 1.2 40s 黄金转化公式说明

系统基于营销视频的"40s 黄金转化公式"，将视频内容分为4个关键阶段：

| 阶段 | 占比 | 目标 | 时长 | 说明 |
|------|------|------|------|------|
| **钩子** (Hook) | 12.5% | 吸引注意 | 5s | 视频开头吸引观众注意力的片段 |
| **产品介绍** (Product Introduction) | 37.5% | 建立认知 | 15s | 产品功能、特点介绍片段 |
| **使用效果** (Usage Effect) | 30% | 建立信任 | 12s | 产品使用效果、用户反馈片段 |
| **促销机制** (Promotion Mechanism) | 20% | 促成行动 | 8s | 促销活动、优惠信息片段 |

#### 1.3 产品类型选择

**选择要分析的产品类型：**

- **蕴淳** (Yun Chun) - 婴幼儿奶粉产品
- **水奶** (Milk) - 液态奶产品
- **蓝钻** (Blue Diamond) - 高端奶粉产品
- **添加** - 添加新的产品类型

> 💡 **提示**：未选择将默认全选所有产品类型

#### 1.4 配置检查

完成配置后，系统会显示配置状态：

- ✅ **已选择输入视频路径** - 输入目录配置完成
- ✅ **已选择输出目录路径** - 输出目录配置完成
- ✅ **产品类型(默认全选)** - 产品类型选择完成

当所有配置项都显示为完成状态时，**"开始分析"** 按钮将变为可用状态（紫色高亮）。

![配置分析界面](UI_step%201%20-%20配置分析01.png)
![配置分析界面2](UI_step%201%20-%20配置分析02.png)

### ⚙️ 步骤2：分析处理

配置完成后，点击 **"开始分析"** 按钮进入分析处理阶段。

#### 2.1 分析进度总览

**顶部进度条显示：**
- **当前进度百分比**：整体分析完成度
- **当前处理文件**：正在分析的视频文件名和序号（如：video_042.mp4 (42/125)）
- **时间统计**：
  - ⏱️ 已用时间：分析已消耗的时间
  - ⏱️ 剩余时间：预计剩余分析时间
- **成本统计**：💰 已花费金额（实时计算）

#### 2.2 详细分析流程

系统采用多阶段分析流程，每个阶段都有独立的进度显示：

**阶段1：视觉识别 (Qwen VL Max)**
- ✅ 状态：已完成
- 功能：视频画面内容识别和分析
- 时间与成本：显示该阶段耗时和费用

**阶段2：品牌感知分析 (Gemini 2.5 Pro)**
- 🔄 状态：进行中
- 功能：品牌相关内容的深度分析
- 进度详情：
  - 完成数量：已完成/总数量
  - 当前文件：正在处理的视频
  - 时间统计：已用时间和预计剩余时间

**阶段3：主标签分类 (待处理)**
- ⏸️ 状态：等待中
- 功能：对视频片段进行主标签分类
- 预计时间：10-15分钟

**阶段4：副标签聚类 (待处理)**
- ⏸️ 状态：等待中
- 功能：对视频片段进行副标签聚类分析
- 预计时间：8-12分钟

#### 2.3 实时文件树更新

**左侧文件目录会实时更新：**
- 显示已完成的分类文件夹
- 每个文件夹显示生成的文件数量
- 新生成的文件会标记 **"NEW"** 标签
- 已完成的文件夹会显示 **"finished"** 状态

#### 2.4 控制操作

- **暂停分析**：暂停当前分析任务（橙色按钮）
- **停止并重置**：停止分析并重置所有进度（红色按钮）

![分析处理界面1](UI_step%202%20-%20分析处理ing01.png)
![分析处理界面2](UI_step%202%20-%20分析处理ing02.png)

### 📊 步骤3：结果查看

分析完成后，系统自动跳转到结果查看页面。

#### 3.1 完成状态提示

**顶部显示完成横幅：**
- ✅ "共125个视频已分析完成! 点击左侧文件树查看详情。"

#### 3.2 分析结果统计

**40s 黄金转化公式 - 流程阶段总览：**

显示每个阶段的生成结果数量：

| 阶段 | 生成数量 | 占比 | 目标 | 时长 |
|------|---------|------|------|------|
| **钩子** | 18个 | 12.5% | 吸引注意 | 5s |
| **产品介绍** | 42个 | 37.5% | 建立认知 | 15s |
| **使用效果** | 35个 | 30% | 建立信任 | 12s |
| **促销机制** | 30个 | 20% | 促成行动 | 8s |

#### 3.3 分析完成摘要

**分析完成卡片显示：**
- 📊 **总视频数**：125个
- ⏱️ **总耗时**：43分59秒
- 💰 **总花费**：¥14.50

#### 3.4 结果文件查看

**左侧文件目录显示：**
- **☆使用效果/** - 18个文件
- **✍产品介绍_蕴淳/** - 42个文件
- **🎯促销机制/** - 35个文件
- **⛓钩子/** - 30个文件
- **详细整合报告.json** - 完整分析报告
- **去重分析汇总.txt** - 去重后的分析汇总

点击左侧文件树中的任意文件夹或文件，可以查看详细的分析结果。

#### 3.5 后续操作

- **重新分析**：点击紫色 **"重新分析"** 按钮可以重新开始分析流程
- **查看详情**：点击左侧文件树中的文件查看具体分析内容

> 💡 **提示**：新生成的文件已用 NEW 标签标记，点击左侧文件树可查看详情

![分析完成界面](UI_step%203%20-%20分析完成.png)

## 🏗️ 系统架构

### 📁 核心目录结构
```
demo/
├── 🍭Origin/                     # 原始视频素材目录
├── 📄SRT/                        # 字幕文件目录
├── 🎬Slice/                      # 切片文件目录
├── video_to_slice/               # 视频智能切片模块
├── video_to_srt/                 # 视频转字幕模块
├── slice_to_label/               # 切片AI分析模块
├── srt_to_product/               # 产品介绍生成模块
├── feishu_pool/                  # 飞书数据池管理
├── mcp_server/                   # MCP服务器
└── n8n-local/                    # 工作流自动化
```

### 🎯 AI模型架构 - 双引擎对称设计

| 分析类型 | 主要模型 | 升级模型 | 切换阈值 |
|---------|---------|---------|---------|
| **视觉标签分析** | Qwen VL Max Latest | Gemini 2.5 Pro | 错误率 > 20% |
| **主标签分析** | DeepSeek Chat | Claude 4 Sonnet | 错误率 > 15% |

## 🚀 核心功能模块

### 1. 🎥 视频智能切片 (video_to_slice)
基于Google Video Intelligence API的智能场景检测和切片

**主要功能：**
- 自动场景检测和镜头切换识别
- 智能语义片段合并
- 并行批处理支持
- 质量验证和优化

**核心文件：**
- `run.py` - 主运行入口
- `src/google_video_analyzer.py` - Google AI分析器
- `src/parallel_batch_processor.py` - 并行批处理器
- `src/semantic_segment_merger.py` - 语义合并器

### 2. 📄 视频转字幕 (video_to_srt)
基于DashScope的高精度语音识别，专为婴幼儿奶粉词汇优化

**主要功能：**
- 婴幼儿奶粉专业词汇识别
- 批量视频转录
- SRT格式输出
- 时间戳精确对齐

**核心文件：**
- `run.py` - 主运行入口
- `src/dashscope_audio_analyzer.py` - 语音识别分析器
- `src/batch_video_to_srt.py` - 批量处理器

### 3. 🏷️ AI智能标签分析 (slice_to_label)
双AI引擎驱动的视频内容智能分析

**主要功能：**
- 视觉内容识别（交互、情绪、场景）
- 智能模型切换（Qwen ↔ Gemini）
- 批量分析处理
- 错误驱动优化

**核心文件：**
- `official_ai_analyzer.py` - 官方AI分析器
- `src/ai_analyzers.py` - 双阶段分析器
- `batch_slice_to_label.py` - 批量处理器

### 4. 🍼 产品介绍生成 (srt_to_product)
基于字幕内容的智能产品介绍视频生成

**主要功能：**
- DeepSeek AI内容分析
- 产品介绍片段提取
- 视频自动剪辑
- 时间戳精确切片

**核心文件：**
- `run.py` - 主运行入口
- `src/deepseek_analyzer.py` - 内容分析器
- `src/video_generator.py` - 视频生成器

### 5. 📊 飞书数据池 (feishu_pool)
统一的数据管理和同步系统

**主要功能：**
- 视频基础池管理
- 切片标签池管理
- 主标签智能分类
- 数据同步和备份

**核心文件：**
- `optimized_data_pool.py` - 数据池管理器
- `unified_complete_sync_v2.py` - 统一同步器
- `deepseek_tag_classifier.py` - 标签分类器

### 6. 🔧 MCP服务器 (mcp_server)
Model Context Protocol服务器，提供AI工具集成

**主要功能：**
- 7大AI工具集成
- Cursor智能决策支持
- 提示词优化
- 系统状态管理

**核心工具：**
- `video_to_slice` - 视频智能切片
- `video_to_srt` - 语音识别
- `slice_to_label` - 视觉标签分析
- `srt_to_product` - 产品生成
- `reclassify_main_labels` - 主标签分类
- `optimize_prompts` - 智能优化

## 🛠️ 快速开始

### 环境要求
- Python 3.8+
- uv (Python包管理器)
- 相关API密钥配置

### 安装步骤

1. **克隆项目**
```bash
git clone <repository>
cd demo
```

2. **环境初始化**
```bash
# 一键环境配置和API密钥设置
./setup_env.sh
```

3. **检查配置状态**
```bash
# 检查环境变量配置状态
./auto_env.sh
```

4. **MCP服务器配置**
```bash
# 配置Cursor MCP集成
./configure_cursor_mcp.sh
```

### 基本使用

#### 🎬 完整视频处理流程

1. **视频切片**
```bash
cd video_to_slice
python run.py
```

2. **字幕生成**
```bash
cd video_to_srt
python run.py
```

3. **AI标签分析**
```bash
cd slice_to_label
python run_analysis.py
```

4. **产品介绍生成**
```bash
cd srt_to_product
python run.py
```

5. **数据同步**
```bash
cd feishu_pool
python unified_complete_sync_v2.py
```

#### 🔧 便捷脚本使用

```bash
# ✨ 新特性：所有脚本现在自动加载环境变量，无需手动配置！

# 视频切片和标签分析
./视频切片_标签.sh

# 产品介绍生成
./视频切片_产品介绍.sh

# 数据上传到飞书
./视频数据_飞书上传.sh

# 检查配置状态
./auto_env.sh
```

## 🎯 使用场景

### 婴幼儿奶粉营销视频分析
- **内容分析**: 自动识别产品介绍、使用效果、促销信息
- **情感分析**: 检测视频中的情绪表达和互动场景
- **标签分类**: 智能分类视频内容标签
- **数据管理**: 结构化存储和管理分析结果

### 批量视频处理
- **并行处理**: 支持多视频同时处理
- **质量控制**: 自动质量检测和优化
- **错误处理**: 智能错误恢复和重试机制

## 🔄 AI模型智能切换

### 视觉分析引擎
- **主力模型**: Qwen VL Max Latest (成本优化)
- **升级模型**: Gemini 2.5 Pro (高精度)
- **切换条件**: 错误率超过20%自动升级

### 主标签分析引擎  
- **主力模型**: DeepSeek Chat (成本优化)
- **升级模型**: Claude 4 Sonnet (高精度)
- **切换条件**: 错误率超过15%自动升级

## 📈 系统优势

### 🎯 智能化
- 多AI模型协同工作
- 错误驱动的自动优化
- 智能决策和模型切换

### 🚀 高性能
- 并行处理架构
- 语义合并优化
- 缓存和重试机制

### 🔧 模块化
- 松耦合设计
- 独立部署支持
- 易于扩展和维护

### 💰 成本优化
- 低成本主力模型 + 高精度升级模型
- 按需升级策略
- 资源使用优化

## 📚 文档和支持

- [视频切片标签使用说明](./视频切片_标签使用说明.md)
- [视频产品介绍使用说明](./视频切片_产品介绍使用说明.md)
- [飞书数据上传使用说明](./视频数据_飞书上传使用说明.md)
- [MCP配置完整指南](./MCP_Cursor_配置完整指南.md)
- [统一系统架构文档](./UNIFIED_SYSTEM_ARCHITECTURE.md)

## 🤝 贡献指南

欢迎提交Issue和Pull Request来改进这个项目！

## 📄 许可证

[MIT License](LICENSE)

---

**AI Video Master** - 让视频分析更智能，让数据管理更简单！ 🎬✨ 